
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/dca83bf159.js" crossorigin="anonymous"></script>   
    <title>Document</title>
</head>
<style>

    header>div{
       
        display: flex;
        align-items: center;

    }
    header{
        display: flex;
        justify-content: space-between;
        padding-left: 20px;
    }

    /* #search_results>div{
        border: 2px solid black;
    } */
    #icon{
        height: 30px;
        width:130px;
    }
    header input{
        padding: 8px 300px;
        font-size: 25px;
    }
    header button{
        padding: 10px 20px;
    }

    
    header .fas{
        font-size: 25px;
    }
    header .last{
        margin-right: 30px;
    }
    header .fa-microphone{
        margin-left: 20px;
    }
    header .fa-bars{
        margin-right: 20px;
    }
    ::placeholder{
        font-size: 25px;
        text-align: left;
    }

    div{
        /* border: 1px solid black; */
    }


    #main{
        display: flex;

        gap: 50px;
        margin-top: 20px;
        padding-left: 20px;
    }
    #recommendation{
        flex: 2;
    }
    #video_details{
        flex: 4;
        
    }
    .subrecommnd{
        display: flex;
        margin-bottom: 10px;
    }
    h3{
        margin-top: 0px;
    }
    .info{
        margin-left: 10px;
    }
    /* #main>div{
         border: 1px solid red; 
    } */
    .commentbox{
        display: flex;
    }
    .infodiv{
        margin-left: 20px;
    }
    .commentbox img{
        border-radius: 50%;
    }
</style>
<body>

    <header>
        <div>
            <i class="fas fa-bars"></i>
            <a href="youtube.html"><img id="icon"
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/YouTube_Logo_2017.svg/2560px-YouTube_Logo_2017.svg.png"
                alt=""></a>
    
    
        </div>
    
        <div>
    
            <input type="text" id="video" placeholder="Search">
            <button onclick="searchVideo()"><i class="fas fa-search"></i></button>
            <i class="fas fa-microphone"></i>
    
    
        </div>
    
        <div>
            <!-- <svg style="display:"
    ><path d="M16,4v4h4V4H16z M19,7h-2V5h2V7z M16,10v4h4v-4H16z M19,13h-2v-2h2V13z M10,4v4h4V4H10z M13,7h-2V5h2V7z M10,10v4h4v-4H10z M13,13h-2v-2h2V13z M16,16v4h4v-4H16z M19,19h-2v-2h2V19z M10,16v4h4v-4H10z M13,19h-2v-2h2V19z M4,4v4h4V4H4z M7,7H5V5h2V7z M4,10 v4h4v-4H4z M7,13H5v-2h2V13z M4,16v4h4v-4H4z M7,19H5v-2h2V19z"></path> </svg> -->
    
    
            <i class=" last fas fa-video"></i>
            <i class=" last fas fa-bell"></i>
            <i class=" last fas fa-user-circle"></i>
    
    
        </div>
    
    </header>

   

    <div id="main">

        <div id="video_details">
            <div class=" videobox"></div>

            <div id="commentdiv"><h3>COMMENTS</h3></div>
        
        </div>

        <div id="recommendation">
           

        </div>

    </div>
    
    
</body>
</html>

<script>

    let appendvideo=()=>{
          let { videoId, snippet, snippet: { title }, snippet: { channelTitle }, snippet: { description }  } = JSON.parse(localStorage.getItem('clicked_video'))
        console.log(snippet)
        console.log(channelTitle)
        console.log(description)
        let recommendation = JSON.parse(localStorage.getItem('recommendation_results'))
        // console.log(recommendation)


        let video_div = document.getElementById('video_details')

        let iframe = document.createElement("iframe")
        iframe.src = `https://www.youtube.com/embed/${videoId}`
        iframe.height = "600px"
        iframe.width = "100%"
        iframe.setAttribute("allowfullscreen", "true")

        let heading = document.createElement('h2')
        heading.textContent=title



        document.querySelector('.videobox').append(iframe,heading)
        // video_div.append(heading)
            // localStorage.removeItem("clicked_video");
            showrecommendation(recommendation,iframe)
            showcomment(videoId)

    }
    appendvideo()
  

   
  

        async function showcomment(videoId) {
        try {
            let video_query = document.querySelector("#video").value
            let response = await fetch(`https://youtube.googleapis.com/youtube/v3/commentThreads?part=snippet&maxResults=50&textFormat=html&videoId=${videoId}&key=AIzaSyARVhX5SK0cgLd39MbemmARw0WsIGALAJk`)
            let data = await response.json()
            // console.log(data)
            let{items}=data
            //  console.log(items)
             appendcomment(items)


            
        }
        catch (er) {
            console.log(er)
        }
    }

    


    function showrecommendation(data,iframe){

        data.map((el)=>{
            
            let { snippet: { thumbnails: { medium: { url } } } } = el
            let { snippet: { title } } = el
            let{snippet:{channelTitle}}=el
            let{id:{videoId}}=el
            let thumb = document.createElement('img')
            thumb.src = url

            let head = document.createElement('h3')
            head.innerHTML = title
            let channelname=document.createElement('p')
            channelname.innerHTML=channelTitle
            let div = document.createElement('div')
            div.setAttribute('class',"subrecommnd")

             let info= document.createElement('div')
             info.setAttribute('class',"info")

             info.append(head,channelname)

             div.append(thumb,info)
            document.querySelector('#recommendation').append(div)

            div.onclick=()=>{
                // console.log(videoId)

                playrecommend(videoId,iframe)

            
              



            }



        //  localStorage.removeItem("recommendation_results");



        })


    }

    function playrecommend(videoId,iframe){
         iframe.src = `https://www.youtube.com/embed/${videoId}`

    }

    let appendcomment=(items)=>{

        items.map((el)=>{
            let{snippet: { topLevelComment:{snippet} }}=el
             let { snippet: { topLevelComment: { snippet:{textOriginal}, snippet: { authorDisplayName}, snippet: { authorProfileImageUrl} } } } = el
             console.log(snippet)
            console.log(textOriginal)
            console.log(authorDisplayName)
            console.log(authorProfileImageUrl)

            let div = document.createElement('div')
            div.setAttribute('class',"commentbox")
               let imgdiv = document.createElement('div')
                  let infodiv = document.createElement('div')
                  infodiv.setAttribute('class',"infodiv")
                    let img=document.createElement('img')
                    img.src= authorProfileImageUrl
                      let name=document.createElement('h3')
                      name.textContent= authorDisplayName
                        let comment=document.createElement('p')
                        comment.textContent= textOriginal

                        imgdiv.append(img)
                        infodiv.append(name,comment)

                        div.append(imgdiv,infodiv)

                        document.querySelector('#commentdiv').append(div)






        })

    }
    
</script>